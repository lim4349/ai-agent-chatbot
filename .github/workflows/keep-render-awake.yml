name: Keep Render Awake

# Render free tier sleeps after 15 minutes of inactivity
# This workflow pings the service every 10 minutes to keep it awake

on:
  schedule:
    - cron: '*/10 * * * *'  # Every 10 minutes
  workflow_dispatch:  # Manual trigger

jobs:
  ping:
    runs-on: ubuntu-latest

    steps:
      - name: Ping Render Service
        env:
          RENDER_URL: ${{ secrets.RENDER_URL }}
        run: |
          if [ -z "$RENDER_URL" ]; then
            echo "‚ö†Ô∏è RENDER_URL not set. Skipping ping."
            echo "Set RENDER_URL in GitHub Secrets to your Render service URL (e.g., https://your-app.onrender.com)"
            exit 0
          fi

          echo "üîÑ Pinging $RENDER_URL..."

          response=$(curl -s -o /dev/null -w "%{http_code}" "$RENDER_URL/api/v1/health" || echo "000")

          if [ "$response" = "200" ]; then
            echo "‚úÖ Service is awake (HTTP 200)"
          elif [ "$response" = "000" ]; then
            echo "‚ö†Ô∏è Could not connect to service"
          else
            echo "‚ÑπÔ∏è Service responded with HTTP $response"
          fi
